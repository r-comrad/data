import{u as b,j as e,b as w,g,r as m}from"./index-475ebcbf.js";import{r as N,s as v,t as y}from"./utils-0d29d525.js";import{u as C}from"./useDispatch-46a20cf1.js";import{F as E}from"./Form-a4bbeb91.js";import{E as j}from"./config-d7ec2646.js";import{M as q}from"./Modal-7e4fc0c0.js";import{b as F}from"./bootstrap.bundle.min-e63a2eff.js";import"./Grow-a1b9d88b.js";function _({contest:a,setCurrentQuestion:s,currentQuestion:l}){var n;const t=C(),o=b();return e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"py-3 fs-3 fw-bold border-bottom",children:a.name}),e.jsx("div",{className:"py-3 flex-grow-1 overflow-auto border-bottom",children:e.jsx("ul",{className:"list-group",children:(n=a.questions)==null?void 0:n.map((r,x)=>e.jsx("li",{className:`list-group-item ${r.id==l?"active":""}`,children:e.jsx("a",{className:`text-decoration-none ${r.id==l?"text-white":"text-dark"}`,href:"#",onClick:()=>{s(r.id)},children:r.name})},x))})}),e.jsx("div",{className:"my-4",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>{t(w({type:"success",text:"Вы успешно вышли из соревнования"})),o("/")},children:"Закончить соревнование"})})]})}function M({currentQuestion:a,GetQuestion:s,UpdateQuestion:l}){function t(){return s()&&s().type=="singl"?[{label:"Ответ",type:j.INPUT,name:"answer",settings:{}}]:s()&&s().type=="bool"?[{label:"Ответ",type:j.COMBOBOX,name:"answer",settings:{options:[{id:"true",label:"Да"},{id:"false",label:"Нет"}]}}]:[]}const o={true:"Да",false:"Нет",tru:"Да",fals:"Нет"};return e.jsx(e.Fragment,{children:a==-1?e.jsxs("div",{className:"h-100 d-flex justify-content-center align-items-center",children:[e.jsx("i",{className:"bi bi-arrow-left fs-1 me-2"}),e.jsx("h3",{className:"m-0",children:"Выберете задание из списка слева"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(q,{title:"Ответ записан",connected_with:"answer",children:['Ответ "',s().type=="bool"?o[s().answer]:s().answer,'" на вопрос "',s().name,'" записан!']}),e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsxs("div",{className:" p-3 d-flex align-items-center border-bottom",children:[e.jsx("h3",{className:"fw-bold m-0 me-3",children:s().name}),s().answer?e.jsxs("p",{className:"text-secondary m-0",children:[e.jsx("i",{className:"bi bi-check-circle me-1"}),"Ответ сохранен"]}):null]}),e.jsx("div",{className:"p-3 flex-grow-1 border-bottom",dangerouslySetInnerHTML:{__html:s().legend}}),e.jsx("div",{className:"my-4 row",children:e.jsx("div",{className:"col-4",children:e.jsx(E,{elements:t(),onSubmit:n=>{N(a,n.answer).then(()=>{l(!0),n.answer&&new F.Modal(document.getElementById("answer"),{}).show()})},additionalClassesButton:s().answer?"btn-outline-primary":void 0,buttonText:s().answer?"Перезаписать ответ":"Отправить ответ",instance:{answer:s().answer?s().answer:null}})})})]})]})})}function A(){const a=g(),[s,l]=m.useState({}),[t,o]=m.useState(-1);m.useEffect(()=>{v(a.contest_id).then(i=>{console.log(i),l(i)})},[]);function n(){var c;let i=(c=s.questions)==null?void 0:c.findIndex(d=>d.id==t);return i==-1?{}:s.questions[i]}function r(i=!1){!t||t==-1||n().legend&&!i||y(t).then(c=>{var u,f,h;const d=(u=s.questions)==null?void 0:u.findIndex(p=>p.id==t);l({...s,questions:[...(f=s.questions)==null?void 0:f.slice(0,d),c,...(h=s.questions)==null?void 0:h.slice(d+1)]})})}function x(){return s.error?new Date(s.start_time)-new Date(s.error):0}return m.useEffect(()=>{r()},[t]),e.jsx("div",{className:"row h-100",style:{maxWidth:"100%"},children:s.error?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-12 h-100 text-center d-flex justify-content-center align-items-center flex-column",children:[e.jsx("div",{children:e.jsx("h1",{children:"Соревнование еще не началось"})}),e.jsxs("p",{children:["Перезагрузите страницу через ",x()]})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-lg-2 col-md-3 border-end h-100 text-center",children:e.jsx(_,{contest:s,currentQuestion:t,setCurrentQuestion:o})}),e.jsx("div",{className:"col-lg-10 col-md-9 h-100 overflow-auto",children:e.jsx(M,{currentQuestion:t,GetQuestion:n,UpdateQuestion:r})})]})})}export{A as default};
