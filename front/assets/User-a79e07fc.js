import{r as u,j as t}from"./index-d01e31b1.js";import{T as S}from"./Table-935d271d.js";import{b as g,F as x,E as r,c as y,M as a,D as N,d as I}from"./utils-d76b11d7.js";import{M as C}from"./MessageBlock-47298185.js";import{M as b,a as f}from"./Modal-9faaa2ba.js";import{G as F}from"./utils-978ca1b9.js";import{b as q}from"./bootstrap.bundle.min-a81abbd8.js";import{P as _}from"./Paginator-bea37458.js";function O(){const[n,o]=u.useState([]),[i,m]=u.useState({}),h=F(),[l,d]=u.useState(0);u.useEffect(()=>{g().then(e=>{o(e)})},[]);function E(e){switch(e){case"admin":return"Администратор";case"teacher":return"Преподаватель";case"student":return"Студент";case"submitor":return"Участник соревнований";default:return e}}function U(e){o(n.filter(s=>!e.includes(s.id))),N(e)}function j(e){e.school_id=h.school_id,i.id&&(e.id=i.id),I(e).then(()=>{g().then(s=>{o(s)})})}function P(e){m(e),new q.Modal(document.getElementById("user_modal"),{}).show()}function T(e,s){const M=n.sort((c,p)=>c[e]>p[e]?s?1:-1:c[e]<p[e]?s?-1:1:0);o([...M])}function w(){return n.slice(l*a,l*a+a)}return t.jsxs(t.Fragment,{children:[t.jsx(C,{}),t.jsx(b,{connected_with:"user_modal",title:"Юзер",children:t.jsx(x,{elements:[{name:"name",label:"Имя",type:r.INPUT,settings:{required:!0}},{name:"surname",label:"Фамилия",type:r.INPUT,settings:{required:!0}},{name:"login",label:"Логин",type:r.INPUT,settings:{required:!0}},{name:"password",label:"Пароль",type:r.INPUT,settings:{required:!0}},{name:"role",label:"Роль",type:r.SELECT,settings:{options:[{value:"admin",text:"Администратор"},{value:"teacher",text:"Преподаватель"},{value:"student",text:"Студент"},{value:"submitor",text:"Участник соревнований"}],multiple:!0,required:!0}}],instance:i,onSubmit:j,buttonText:"Отправить"})}),t.jsx(f,{connected_with:"user_modal",additionalClasses:"m-3",preOpen:()=>{m({})},button_text:"Создание юзера"}),t.jsx(b,{connected_with:"multiple_users_modal",title:"Загрузка через файл",children:t.jsx(x,{elements:[{name:"file",label:"Файл",type:r.FILE,settings:{}}],onSubmit:e=>{y(e.file)},buttonText:"Отправить"})}),t.jsx(f,{connected_with:"multiple_users_modal",button_text:"Загрузить через файл"}),t.jsx(_,{max_page:n.length/a,current_page:l,onPageChange:e=>{d(e)}}),t.jsx(S,{elements:w(),additional_classes:"mt-3",table_fields:[{name:"name",label:"Имя"},{name:"surname",label:"Фамилия"},{name:"login",label:"Логин"},{name:"password",label:"Пароль"},{name:"role",label:"Роль",valueProcessing:e=>e.map(s=>E(s)).join(", "),width:20}],NeedEdit:!0,NeedDelete:!0,onEdit:P,onDelete:U,Sort:T}),t.jsx(_,{max_page:n.length/a,current_page:l,onPageChange:e=>{d(e)}})]})}export{O as default};
