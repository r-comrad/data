import{r as o,j as a}from"./index-50c8aee8.js";import{f as p,g as h,F as P,E as c,h as g,C as y}from"./utils-bafe39db.js";import{T as F}from"./Table-85f89527.js";import{M as T,a as w,b as C}from"./Modal-3506476a.js";function A(){const[i,r]=o.useState([]),[u,b]=o.useState([]),[d,m]=o.useState({});o.useEffect(()=>{p().then(e=>{r(e)}),h().then(e=>{b(e)})},[]);function j(e){var n;const t=(n=u.find(s=>s.id===e))==null?void 0:n.name;return t||"Неизвестный предмет"}function x(e){r(i.filter(t=>t.id?!e.includes(t.id):!0)),g(e)}function E(e){d.id&&(e.id=d.id),y(e).then(()=>{p().then(t=>{r(t)})})}function S(e){m(e),new C.Modal(document.getElementById("plan_modal"),{}).show()}function l(e,t){var n;return t!="subject_id"?e[t]:(n=u.find(s=>s.id===e.subject_id))==null?void 0:n.name}function _(e,t){const n=i.sort((s,f)=>l(s,e)>l(f,e)?t?1:-1:l(s,e)<l(f,e)?t?-1:1:0);r([...n])}return a.jsxs(a.Fragment,{children:[a.jsx(T,{connected_with:"plan_modal",title:"План",children:a.jsx(P,{elements:[{label:"Название",name:"name",type:c.INPUT,settings:{required:!0}},{label:"Предмет",name:"subject_id",type:c.SMART_SELECT,settings:{options:u.map(e=>({value:e.id,text:e.name}))}},{label:"Файл",name:"file",type:c.FILE,settings:{required:!0}}],instance:d,onSubmit:E})}),a.jsx(w,{connected_with:"plan_modal",button_text:"Добавить план",additionalClasses:"m-3",preOpen:()=>m({})}),a.jsx(F,{elements:i,table_fields:[{label:"Название",name:"name"},{label:"Предмет",name:"subject_id",valueProcessing:j}],NeedDelete:!0,NeedEdit:!0,onDelete:x,onEdit:S,Sort:_})]})}export{A as default};
