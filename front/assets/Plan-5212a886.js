import{r as i,j as s}from"./index-4fc6d3e1.js";import{e as f,f as S,g as _,C as g}from"./utils-d9615ed8.js";import{T as y}from"./Table-a3c22f31.js";import{M as F}from"./Modal-16c8bc24.js";import{M}from"./ModalButton-c486e6eb.js";import{F as w}from"./Form-c17a99b6.js";import{E as d}from"./types-ea6d41af.js";import{b as B}from"./bootstrap.bundle.min-3b8a8c88.js";import"./axios-4a70c6fc.js";import"./utils-89423bbb.js";import"./Grow-f6363472.js";function R(){const[l,o]=i.useState([]),[u,b]=i.useState([]),[m,c]=i.useState({});i.useEffect(()=>{f().then(e=>{o(e)}),S().then(e=>{b(e)})},[]);function j(e){var n;const t=(n=u.find(r=>r.id===e))==null?void 0:n.name;return t||"Неизвестный предмет"}function x(e){o(l.filter(t=>t.id?!e.includes(t.id):!0)),_(e)}function E(e){m.id&&(e.id=m.id),g(e).then(()=>{f().then(t=>{o(t)})})}function P(e){c(e),new B.Modal(document.getElementById("plan_modal"),{}).show()}function a(e,t){var n;return t!="subject_id"?e[t]:(n=u.find(r=>r.id===e.subject_id))==null?void 0:n.name}function h(e,t){const n=l.sort((r,p)=>a(r,e)>a(p,e)?t?1:-1:a(r,e)<a(p,e)?t?-1:1:0);o([...n])}return s.jsxs(s.Fragment,{children:[s.jsx(F,{connected_with:"plan_modal",title:"План",children:s.jsx(w,{elements:[{label:"Название",name:"name",type:d.INPUT,settings:{required:!0}},{label:"Предмет",name:"subject_id",type:d.COMBOBOX,settings:{options:u.map(e=>({id:e.id,label:e.name}))}},{label:"Файл",name:"file",type:d.FILE,settings:{required:!0}}],instance:m,onSubmit:E})}),s.jsx(M,{connected_with:"plan_modal",button_text:"Добавить план",additionalClasses:"m-3",preOpen:()=>c({})}),s.jsx(y,{elements:l,table_fields:[{label:"Название",name:"name"},{label:"Предмет",name:"subject_id",valueProcessing:j}],NeedDelete:!0,NeedEdit:!0,onDelete:x,onEdit:P,Sort:h})]})}export{R as default};
