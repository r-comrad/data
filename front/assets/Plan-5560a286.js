import{r as l,j as a}from"./index-ac9c09ba.js";import{e as p,f as _,F as h,E as m,g,C as y}from"./utils-a5a48fe5.js";import{T as F}from"./Table-5d1b32c1.js";import{M as T,a as w}from"./Modal-122696de.js";import{b as C}from"./bootstrap.bundle.min-a4fb55f5.js";function B(){const[i,r]=l.useState([]),[u,b]=l.useState([]),[d,c]=l.useState({});l.useEffect(()=>{p().then(e=>{r(e)}),_().then(e=>{b(e)})},[]);function j(e){var n;const t=(n=u.find(s=>s.id===e))==null?void 0:n.name;return t||"Неизвестный предмет"}function x(e){r(i.filter(t=>t.id?!e.includes(t.id):!0)),g(e)}function E(e){d.id&&(e.id=d.id),y(e).then(()=>{p().then(t=>{r(t)})})}function S(e){c(e),new C.Modal(document.getElementById("plan_modal"),{}).show()}function o(e,t){var n;return t!="subject_id"?e[t]:(n=u.find(s=>s.id===e.subject_id))==null?void 0:n.name}function P(e,t){const n=i.sort((s,f)=>o(s,e)>o(f,e)?t?1:-1:o(s,e)<o(f,e)?t?-1:1:0);r([...n])}return a.jsxs(a.Fragment,{children:[a.jsx(T,{connected_with:"plan_modal",title:"План",children:a.jsx(h,{elements:[{label:"Название",name:"name",type:m.INPUT,settings:{required:!0}},{label:"Предмет",name:"subject_id",type:m.SMART_SELECT,settings:{options:u.map(e=>({value:e.id,text:e.name}))}},{label:"Файл",name:"file",type:m.FILE,settings:{required:!0}}],instance:d,onSubmit:E})}),a.jsx(w,{connected_with:"plan_modal",button_text:"Добавить план",additionalClasses:"m-3",preOpen:()=>c({})}),a.jsx(F,{elements:i,table_fields:[{label:"Название",name:"name"},{label:"Предмет",name:"subject_id",valueProcessing:j}],NeedDelete:!0,NeedEdit:!0,onDelete:x,onEdit:S,Sort:P})]})}export{B as default};
